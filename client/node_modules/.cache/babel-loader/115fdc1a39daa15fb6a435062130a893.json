{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/KASIM/Documents/bookist-alpha/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/KASIM/Documents/bookist-alpha/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/KASIM/Documents/bookist-alpha/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useNavigate}from\"react-router\";import{v4 as uuidv4}from\"uuid\";import{updateBooklistName,purgeNonUser}from\"../../services/librarySlice\";import classes from\"./Booklist.module.css\";import BooklistFooter from\"./footer/BooklistFooter\";import BooklistItem from\"./item/BooklistItem\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Booklist(_ref){var booklistObj=_ref.booklistObj,getBooklistTitles=_ref.getBooklistTitles;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),books=_useState2[0],setBooks=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),editTitle=_useState4[0],setEditTitle=_useState4[1];var navigate=useNavigate();var userBooks=useSelector(function(state){return state.library.userBooks;});var dispatch=useDispatch();useEffect(function(){if(books===null){dispatch(purgeNonUser());setBooks(userBooks.filter(function(book){return book.booklists&&book.booklists.includes(booklistObj.booklist_title);}));}},[dispatch,booklistObj.booklist_title,userBooks,books]);var onBooklistRenameClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(newBooklistTitle){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(newBooklistTitle!==booklistObj.booklist_title&&newBooklistTitle.length>0&&newBooklistTitle!==\"Read Books\")){_context.next=5;break;}_context.next=3;return axios.put(\"/api/library/booklist/rename\",{booklist_id:booklistObj.booklist_id,booklistTitle:newBooklistTitle});case 3:dispatch(updateBooklistName({oldName:booklistObj.booklist_title,newName:newBooklistTitle}));getBooklistTitles();case 5:setEditTitle(false);case 6:case\"end\":return _context.stop();}}},_callee);}));return function onBooklistRenameClick(_x){return _ref2.apply(this,arguments);};}();var onBooklistDeleteClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(\"/api/library/booklist/delete\",{booklistTitle:booklistObj.booklist_title});case 2:dispatch(updateBooklistName({type:\"delete\",oldName:booklistObj.booklist_title}));getBooklistTitles();case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function onBooklistDeleteClick(){return _ref3.apply(this,arguments);};}();var onExpandEditClick=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:navigate(\"/booklist/?id=\".concat(booklistObj.booklist_id,\"&title=\").concat(booklistObj.booklist_title));case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function onExpandEditClick(){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:books!==null&&/*#__PURE__*/_jsxs(\"div\",{className:classes.booklist,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.body,children:books&&books.map(function(book){return/*#__PURE__*/_jsx(BooklistItem,{book:book},uuidv4());})}),/*#__PURE__*/_jsx(BooklistFooter,{editTitle:editTitle,setEditTitle:setEditTitle,onBooklistRenameClick:onBooklistRenameClick,books:books,booklistObj:booklistObj,onBooklistDeleteClick:onBooklistDeleteClick,onExpandEditClick:onExpandEditClick})]})});}","map":{"version":3,"sources":["C:/Users/KASIM/Documents/bookist-alpha/client/src/components/booklist/Booklist.jsx"],"names":["axios","useEffect","useState","useDispatch","useSelector","useNavigate","v4","uuidv4","updateBooklistName","purgeNonUser","classes","BooklistFooter","BooklistItem","Booklist","booklistObj","getBooklistTitles","books","setBooks","editTitle","setEditTitle","navigate","userBooks","state","library","dispatch","filter","book","booklists","includes","booklist_title","onBooklistRenameClick","newBooklistTitle","length","put","booklist_id","booklistTitle","oldName","newName","onBooklistDeleteClick","post","type","onExpandEditClick","booklist","body","map"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useNavigate } from \"react-router\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport { updateBooklistName, purgeNonUser } from \"../../services/librarySlice\";\r\nimport classes from \"./Booklist.module.css\";\r\nimport BooklistFooter from \"./footer/BooklistFooter\";\r\nimport BooklistItem from \"./item/BooklistItem\";\r\n\r\nexport default function Booklist({ booklistObj, getBooklistTitles }) {\r\n   const [books, setBooks] = useState(null);\r\n   const [editTitle, setEditTitle] = useState(false);\r\n   const navigate = useNavigate();\r\n\r\n   const userBooks = useSelector((state) => state.library.userBooks);\r\n   const dispatch = useDispatch();\r\n\r\n   useEffect(() => {\r\n      if (books === null) {\r\n         dispatch(purgeNonUser());\r\n         setBooks(\r\n            userBooks.filter(\r\n               (book) =>\r\n                  book.booklists &&\r\n                  book.booklists.includes(booklistObj.booklist_title)\r\n            )\r\n         );\r\n      }\r\n   }, [dispatch, booklistObj.booklist_title, userBooks, books]);\r\n\r\n   const onBooklistRenameClick = async (newBooklistTitle) => {\r\n      if (\r\n         newBooklistTitle !== booklistObj.booklist_title &&\r\n         newBooklistTitle.length > 0 &&\r\n         newBooklistTitle !== \"Read Books\"\r\n      ) {\r\n         await axios.put(\"/api/library/booklist/rename\", {\r\n            booklist_id: booklistObj.booklist_id,\r\n            booklistTitle: newBooklistTitle,\r\n         });\r\n         dispatch(\r\n            updateBooklistName({\r\n               oldName: booklistObj.booklist_title,\r\n               newName: newBooklistTitle,\r\n            })\r\n         );\r\n         getBooklistTitles();\r\n      }\r\n      setEditTitle(false);\r\n   };\r\n\r\n   const onBooklistDeleteClick = async () => {\r\n      await axios.post(\"/api/library/booklist/delete\", {\r\n         booklistTitle: booklistObj.booklist_title,\r\n      });\r\n      dispatch(\r\n         updateBooklistName({\r\n            type: \"delete\",\r\n            oldName: booklistObj.booklist_title,\r\n         })\r\n      );\r\n\r\n      getBooklistTitles();\r\n   };\r\n\r\n   const onExpandEditClick = async () => {\r\n      navigate(\r\n         `/booklist/?id=${booklistObj.booklist_id}&title=${booklistObj.booklist_title}`\r\n      );\r\n   };\r\n\r\n   return (\r\n      <>\r\n         {books !== null && (\r\n            <div className={classes.booklist}>\r\n               <div className={classes.body}>\r\n                  {books &&\r\n                     books.map((book) => (\r\n                        <BooklistItem book={book} key={uuidv4()} />\r\n                     ))}\r\n               </div>\r\n\r\n               <BooklistFooter\r\n                  editTitle={editTitle}\r\n                  setEditTitle={setEditTitle}\r\n                  onBooklistRenameClick={onBooklistRenameClick}\r\n                  books={books}\r\n                  booklistObj={booklistObj}\r\n                  onBooklistDeleteClick={onBooklistDeleteClick}\r\n                  onExpandEditClick={onExpandEditClick}\r\n               />\r\n            </div>\r\n         )}\r\n      </>\r\n   );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}