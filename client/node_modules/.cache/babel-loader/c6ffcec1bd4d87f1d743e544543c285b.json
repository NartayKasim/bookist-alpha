{"ast":null,"code":"import _toConsumableArray from\"C:/Users/KASIM/Documents/bookist-alpha/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/KASIM/Documents/bookist-alpha/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/KASIM/Documents/bookist-alpha/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{createSlice,createAsyncThunk}from\"@reduxjs/toolkit\";import axios from\"axios\";var initialState={isLoggedIn:false,userBooks:[]};export var getUserBooks=createAsyncThunk(\"library/getUserBooks\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"a\");_context.next=3;return axios.get(\"/api/library/\");case 3:response=_context.sent;return _context.abrupt(\"return\",response.data);case 5:case\"end\":return _context.stop();}}},_callee);})));export var submitRating=createAsyncThunk(\"library/submitRating\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(bookObj){var book,rating,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:book=bookObj.book,rating=bookObj.rating;_context2.next=3;return axios.post(\"/api/library/rate\",{book:book,rating:rating});case 3:response=_context2.sent;return _context2.abrupt(\"return\",response.data);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}());var librarySlice=createSlice({name:\"library\",initialState:initialState,reducers:{toggleIsLoggedIn:function toggleIsLoggedIn(state,action){state.isLoggedIn=!state.isLoggedIn;return state;},purgeNonUser:function purgeNonUser(state,action){if(action.payload===\"id\"){var newState=state.userBooks.filter(function(book){return book&&book.book_id;});state.userBooks=_toConsumableArray(newState);}else{if(!action.payload){var _newState=state.userBooks.filter(function(book){return book.booklists&&book.booklists.length>0&&book;});state.userBooks=_toConsumableArray(_newState);}}return state;},updateUserBooks:function updateUserBooks(state,action){var targetBookId=action.payload.book_id;var newState=state.userBooks.filter(function(book){return book.book_id!==targetBookId;});state.userBooks=[].concat(_toConsumableArray(newState),[action.payload]);return state;},updateBooklistName:function updateBooklistName(state,action){if(action.payload.type===\"delete\"){for(var i=0;i<state.userBooks.length;i++){if(state.userBooks[i].booklists.includes(action.payload.oldName)){state.userBooks[i].booklists.splice(state.userBooks[i].booklists.indexOf(action.payload.oldName));}}}else{for(var _i=0;_i<state.userBooks.length;_i++){if(state.userBooks[_i].booklists.includes(action.payload.oldName)){state.userBooks[_i].booklists.splice(state.userBooks[_i].booklists.indexOf(action.payload.oldName));state.userBooks[_i].booklists.push(action.payload.newName);}}}return state;},clearBooklists:function clearBooklists(state,action){state.userBooks=action.payload;return state;}},extraReducers:function extraReducers(builder){builder.addCase(getUserBooks.fulfilled,function(state,action){var payload=action.payload;state.userBooks=_toConsumableArray(payload);return state;}).addCase(submitRating.fulfilled,function(state,action){return state;});}});var _librarySlice$actions=librarySlice.actions,toggleIsLoggedIn=_librarySlice$actions.toggleIsLoggedIn,clearBooklists=_librarySlice$actions.clearBooklists,purgeNonUser=_librarySlice$actions.purgeNonUser,updateUserBooks=_librarySlice$actions.updateUserBooks,updateBooklistName=_librarySlice$actions.updateBooklistName;export{toggleIsLoggedIn,clearBooklists,purgeNonUser,updateUserBooks,updateBooklistName};export default librarySlice.reducer;","map":{"version":3,"sources":["C:/Users/KASIM/Documents/bookist-alpha/client/src/services/librarySlice.js"],"names":["createSlice","createAsyncThunk","axios","initialState","isLoggedIn","userBooks","getUserBooks","console","log","get","response","data","submitRating","bookObj","book","rating","post","librarySlice","name","reducers","toggleIsLoggedIn","state","action","purgeNonUser","payload","newState","filter","book_id","booklists","length","updateUserBooks","targetBookId","updateBooklistName","type","i","includes","oldName","splice","indexOf","push","newName","clearBooklists","extraReducers","builder","addCase","fulfilled","actions","reducer"],"mappings":"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","sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\n\r\nconst initialState = {\r\n   isLoggedIn: false,\r\n   userBooks: [],\r\n};\r\n\r\nexport const getUserBooks = createAsyncThunk(\r\n   \"library/getUserBooks\",\r\n   async () => {\r\n      console.log(\"a\");\r\n      const response = await axios.get(\"/api/library/\");\r\n      return response.data;\r\n   }\r\n);\r\n\r\nexport const submitRating = createAsyncThunk(\r\n   \"library/submitRating\",\r\n   async (bookObj) => {\r\n      const { book, rating } = bookObj;\r\n      const response = await axios.post(\"/api/library/rate\", { book, rating });\r\n      return response.data;\r\n   }\r\n);\r\n\r\nconst librarySlice = createSlice({\r\n   name: \"library\",\r\n   initialState,\r\n   reducers: {\r\n      toggleIsLoggedIn(state, action) {\r\n         state.isLoggedIn = !state.isLoggedIn;\r\n         return state;\r\n      },\r\n\r\n      purgeNonUser(state, action) {\r\n         if (action.payload === \"id\") {\r\n            const newState = state.userBooks.filter(\r\n               (book) => book && book.book_id\r\n            );\r\n            state.userBooks = [...newState];\r\n         } else {\r\n            if (!action.payload) {\r\n               const newState = state.userBooks.filter(\r\n                  (book) => book.booklists && book.booklists.length > 0 && book\r\n               );\r\n               state.userBooks = [...newState];\r\n            }\r\n         }\r\n         return state;\r\n      },\r\n\r\n      updateUserBooks(state, action) {\r\n         const targetBookId = action.payload.book_id;\r\n         const newState = state.userBooks.filter(\r\n            (book) => book.book_id !== targetBookId\r\n         );\r\n         state.userBooks = [...newState, action.payload];\r\n         return state;\r\n      },\r\n\r\n      updateBooklistName(state, action) {\r\n         if (action.payload.type === \"delete\") {\r\n            for (let i = 0; i < state.userBooks.length; i++) {\r\n               if (\r\n                  state.userBooks[i].booklists.includes(action.payload.oldName)\r\n               ) {\r\n                  state.userBooks[i].booklists.splice(\r\n                     state.userBooks[i].booklists.indexOf(\r\n                        action.payload.oldName\r\n                     )\r\n                  );\r\n               }\r\n            }\r\n         } else {\r\n            for (let i = 0; i < state.userBooks.length; i++) {\r\n               if (\r\n                  state.userBooks[i].booklists.includes(action.payload.oldName)\r\n               ) {\r\n                  state.userBooks[i].booklists.splice(\r\n                     state.userBooks[i].booklists.indexOf(\r\n                        action.payload.oldName\r\n                     )\r\n                  );\r\n                  state.userBooks[i].booklists.push(action.payload.newName);\r\n               }\r\n            }\r\n         }\r\n         return state;\r\n      },\r\n\r\n      clearBooklists(state, action) {\r\n         state.userBooks = action.payload;\r\n         return state;\r\n      },\r\n   },\r\n   extraReducers: (builder) => {\r\n      builder\r\n         .addCase(getUserBooks.fulfilled, (state, action) => {\r\n            const { payload } = action;\r\n            state.userBooks = [...payload];\r\n            return state;\r\n         })\r\n         .addCase(submitRating.fulfilled, (state, action) => {\r\n            return state;\r\n         });\r\n   },\r\n});\r\n\r\nexport const {\r\n   toggleIsLoggedIn,\r\n   clearBooklists,\r\n   purgeNonUser,\r\n   updateUserBooks,\r\n   updateBooklistName,\r\n} = librarySlice.actions;\r\nexport default librarySlice.reducer;\r\n"]},"metadata":{},"sourceType":"module"}