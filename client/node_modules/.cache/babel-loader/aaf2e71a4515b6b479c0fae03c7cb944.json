{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/KASIM/Documents/bookist-alpha/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/KASIM/Documents/bookist-alpha/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/KASIM/Documents/bookist-alpha/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect}from\"react\";import{useState,useMemo}from\"react\";// import { useSelector } from \"react-redux\";\nimport axios from\"axios\";import classes from\"./AddToBooklist.module.css\";import CurrentBooklists from\"./CurrentBooklists\";import AvailableBooklists from\"./AvailableBooklists\";import CreateNewBooklist from\"./CreateNewBooklist\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function AddToBooklist(_ref){var book=_ref.book,setBook=_ref.setBook;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),booklists=_useState2[0],setBooklists=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),displayAddToBooklist=_useState4[0],setDisplayAddToBooklist=_useState4[1];var booklistsFromState=useMemo(function(){return book.booklists||[];},[book.booklists]);var availableBooklists=booklists!==null&&booklists.filter(function(booklist){return!booklistsFromState.includes(booklist.booklist_title);});var createNewBooklist=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(newBooklistName){var response,bookObj;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post(\"/api/library/booklist-create\",{newBooklistName:newBooklistName,book:book});case 2:response=_context.sent;bookObj=response.data;setDisplayAddToBooklist(false);setBook(bookObj);case 6:case\"end\":return _context.stop();}}},_callee);}));return function createNewBooklist(_x){return _ref2.apply(this,arguments);};}();var addToBooklist=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(idx){var response,bookObj;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.put(\"/api/library/booklist-add\",{book:book,booklist_id:availableBooklists[idx].booklist_id});case 2:response=_context2.sent;bookObj=response.data;setDisplayAddToBooklist(false);setBook(bookObj);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function addToBooklist(_x2){return _ref3.apply(this,arguments);};}();useEffect(function(){var getBooklistNames=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,booklistsTotal;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get(\"/api/library/booklist-names\");case 2:response=_context3.sent;booklistsTotal=response.data;setBooklists(booklistsTotal);case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function getBooklistNames(){return _ref4.apply(this,arguments);};}();if(booklists===null){getBooklistNames();}},[booklistsFromState,booklists]);return/*#__PURE__*/_jsxs(\"div\",{className:classes.addToBooklist,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.currentBooklistsWrapper,children:[booklistsFromState&&booklistsFromState.length>0&&/*#__PURE__*/_jsx(\"span\",{children:\"Included In:\"}),/*#__PURE__*/_jsx(CurrentBooklists,{booklists:booklistsFromState||[]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setDisplayAddToBooklist(!displayAddToBooklist);},className:classes.addToBooklistButton,children:\"Add To Booklist\"}),displayAddToBooklist&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.availableBooklistsWrapper,children:[availableBooklists&&availableBooklists.length>0&&/*#__PURE__*/_jsx(AvailableBooklists,{addToBooklist:addToBooklist,availableBooklists:availableBooklists}),availableBooklists&&availableBooklists.length===0&&/*#__PURE__*/_jsx(\"strong\",{children:\"There are no booklists available. Create a new booklist below.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:classes.createNewBooklistWrapper,children:booklists&&/*#__PURE__*/_jsx(CreateNewBooklist,{createNewBooklist:createNewBooklist,booklists:booklists,availableBooklists:availableBooklists})})]})]});}","map":{"version":3,"sources":["C:/Users/KASIM/Documents/bookist-alpha/client/src/components/book/booklist/AddToBooklist.jsx"],"names":["useEffect","useState","useMemo","axios","classes","CurrentBooklists","AvailableBooklists","CreateNewBooklist","AddToBooklist","book","setBook","booklists","setBooklists","displayAddToBooklist","setDisplayAddToBooklist","booklistsFromState","availableBooklists","filter","booklist","includes","booklist_title","createNewBooklist","newBooklistName","post","response","bookObj","data","addToBooklist","idx","put","booklist_id","getBooklistNames","get","booklistsTotal","currentBooklistsWrapper","length","addToBooklistButton","availableBooklistsWrapper","createNewBooklistWrapper"],"mappings":"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","sourcesContent":["import { useEffect } from \"react\";\r\nimport { useState, useMemo } from \"react\";\r\n// import { useSelector } from \"react-redux\";\r\nimport axios from \"axios\";\r\nimport classes from \"./AddToBooklist.module.css\";\r\nimport CurrentBooklists from \"./CurrentBooklists\";\r\nimport AvailableBooklists from \"./AvailableBooklists\";\r\nimport CreateNewBooklist from \"./CreateNewBooklist\";\r\n\r\nexport default function AddToBooklist({ book, setBook }) {\r\n   const [booklists, setBooklists] = useState(null);\r\n   const [displayAddToBooklist, setDisplayAddToBooklist] = useState(false);\r\n\r\n   const booklistsFromState = useMemo(\r\n      () => book.booklists || [],\r\n      [book.booklists]\r\n   );\r\n   const availableBooklists =\r\n      booklists !== null &&\r\n      booklists.filter(\r\n         (booklist) => !booklistsFromState.includes(booklist.booklist_title)\r\n      );\r\n\r\n   const createNewBooklist = async (newBooklistName) => {\r\n      const response = await axios.post(\"/api/library/booklist-create\", {\r\n         newBooklistName,\r\n         book,\r\n      });\r\n      const bookObj = response.data;\r\n      setDisplayAddToBooklist(false);\r\n      setBook(bookObj);\r\n   };\r\n\r\n   const addToBooklist = async (idx) => {\r\n      const response = await axios.put(\"/api/library/booklist-add\", {\r\n         book,\r\n         booklist_id: availableBooklists[idx].booklist_id,\r\n      });\r\n      const bookObj = response.data;\r\n      setDisplayAddToBooklist(false);\r\n      setBook(bookObj);\r\n   };\r\n\r\n   useEffect(() => {\r\n      const getBooklistNames = async () => {\r\n         const response = await axios.get(\"/api/library/booklist-names\");\r\n         const booklistsTotal = response.data;\r\n         setBooklists(booklistsTotal);\r\n      };\r\n      if (booklists === null) {\r\n         getBooklistNames();\r\n      }\r\n   }, [booklistsFromState, booklists]);\r\n\r\n   return (\r\n      <div className={classes.addToBooklist}>\r\n         <div className={classes.currentBooklistsWrapper}>\r\n            {booklistsFromState && booklistsFromState.length > 0 && (\r\n               <span>Included In:</span>\r\n            )}\r\n            <CurrentBooklists booklists={booklistsFromState || []} />\r\n         </div>\r\n         <button\r\n            onClick={() => setDisplayAddToBooklist(!displayAddToBooklist)}\r\n            className={classes.addToBooklistButton}\r\n         >\r\n            Add To Booklist\r\n         </button>\r\n         {displayAddToBooklist && (\r\n            <>\r\n               <div className={classes.availableBooklistsWrapper}>\r\n                  {availableBooklists && availableBooklists.length > 0 && (\r\n                     <AvailableBooklists\r\n                        addToBooklist={addToBooklist}\r\n                        availableBooklists={availableBooklists}\r\n                     />\r\n                  )}\r\n                  {availableBooklists && availableBooklists.length === 0 && (\r\n                     <strong>\r\n                        There are no booklists available. Create a new booklist\r\n                        below.\r\n                     </strong>\r\n                  )}\r\n               </div>\r\n               <div className={classes.createNewBooklistWrapper}>\r\n                  {booklists && (\r\n                     <CreateNewBooklist\r\n                        createNewBooklist={createNewBooklist}\r\n                        booklists={booklists}\r\n                        availableBooklists={availableBooklists}\r\n                     />\r\n                  )}\r\n               </div>\r\n            </>\r\n         )}\r\n      </div>\r\n   );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}